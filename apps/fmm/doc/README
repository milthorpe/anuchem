Fast Multipole Method molecular mechanics code, part of ANU-Chem

This program is controlled by the Eclipse Public Licence v1.0 http://www.eclipse.org/legal/epl-v10.html

Introduction:
------------

This code performs an electrostatic potential calculation using the Fast Multipole
Method with analytic expansions.

The implementation basically follows White & Head-Gordon (1994), with some enhancements taken from Lashuk et al. (2009) such as the use of Locally Essential Trees.

The potential calculation by itself is not very useful; in the future we hope to incorporate it into a dynamics code.  For now, it provides an illustration of the possible use of X10 language constructs to construct a distributed tree code.

1. White & Head-Gordon (1994). "Derivation and efficient implementation of the fast multipole method". J Chem Phys 101 (8)
2. Lashuk et al. (2009). "A massively parallel adaptive fast-multipole method on heterogeneous architectures". Proceedings of SC 2009


Compiling:
----------

$ ant clean && ant

will build the executable bin/fmm3d

The default build script builds against MPI and therefore requires an X10 runtime built with X10RT_MPI=true.
To build for Blue Gene change ${x10rt} to "pgas_bgp"


Compile dependencies:
------------------------
* X10 version 2.1.2 including x10rt=mpi
* anu-chem library
* x10x.lib library


To run:
------

Single place:

runx10 bin/fmm3d numAtoms [density] [numTerms] [wellSpaced]

Multiple place:

mpiexec -n <n> bin/fmm3d numAtoms [density] [numTerms] [wellSpaced]

where <n> is number of places

- numParticles is self explanatory
- density is a "target density" for the mean number of particles per lowest-level box.  The default value is 3.0; a larger value means less levels in the tree, which gives less accurate results and shorter run time.
- numTerms is the number of terms "p" at which to truncate multipole and local expansions.  The default is 10; the larger the value, the more accurate the result and the longer the run time.
- wellSpaced is the number of intervening boxes by which a pair of boxes must be separated to be considered "well spaced".  The default is 2; the larger the value, the accurate the result and the longer the run time. 

