Introduction:
------------

This code performs an electrostatic potential calculation using the Smooth Particle Mesh Ewald method.

The implementation follows Essmann et al. (1994), with some insights regarding the 3D FFT from Oh & Deng (2007).

The potential calculation by itself is not very useful; in the future we hope to incorporate it into a dynamics code.  For now, it provides an illustration of the possible use of X10 language constructs in structured grid codes and spectral methods.

1. Essmann et al. (1995). "A smmoth particle mesh Ewald method". J Chem Phys 103 (19), 8577-93
2. Oh and Deng (2007). "An efficient parallel implementation of the smooth particle mesh Ewald method for molecular dynamics simulations". Comp Phys Comms 177 (5), 426


Compiling:
----------

$ ant clean && ant

will build the executable bin/pme

The default build script builds agaist mpi.
To build for Blue Gene change ${x10rt} to "pgas_bgp"


Compile dependencies:
------------------------
* FFTW http://www.fftw.org/ 
  (linked to at the locations ${fftw3.include} and ${fftw3.lib} in the ant build script)
* anu-chem library
* x10x.lib library
* Periodic Array patches to X10 array libraries - see http://jira.codehaus.org/browse/XTENLANG-1365

To run:
------

Single place:

runx10 bin/pme numAtoms [ewaldCoefficient] [cutoff] [gridSize] [splineOrder]

Multiple place:

mpiexec -n <n> bin/pme numAtoms [ewaldCoefficient] [cutoff] [gridSize] [splineOrder]

where <n> is number of places

- numAtoms is self explanatory
- ewaldCoefficient is the parameter 'Beta' which controls the tradeoff between the convergence of long-range and short-range components.  The default value is 0.35.
- cutoff is the distance in Angstroms beyond which direct evaluation of force/potential does not occur.  The default value is 10.0.
- gridSize is the number of grid points in each dimension of the (cubic) simulation cell.
- splineOrder is the number of grid points in each dimension over which charges are spread using b-spline interpolation.
For detailed explanation of all parameters, see Essman et al. (1995).

